databaseChangeLog:
  - changeSet:
      id: 20200902_routes_v1_20200902_table
      context: dev or pre or pro
      author: axel.sanchezsalom
      comment: "Add routes table to the database"
      changes:

        # Routes
        - createTable:
            tableName: routes
            remarks: Routes table
            columns:
              - column:
                  name: id
                  type: int
                  remarks: route id
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: route_id_pk
              - column:
                  name: label
                  type: varchar(255)
                  remarks: Route label (airport codes)
                  constraints:
                    nullable: false
              - column:
                  name: frequency
                  type: varchar(50)
                  remarks: route frequency
              - column:
                  name: start_date
                  type: date
                  remarks: route start date
                  constraints:
                    nullable: false
              - column:
                  name: end_date
                  type: date
                  remarks: route end date
                  constraints:
                    nullable: false
              - column:
                  name: file_id
                  type: int
                  remarks: file id
                  constraints:
                    nullable: false
                    foreignKeyName: routes_files_fk
                    references: files(id)
              - column:
                  name: rotations
                  type: int
                  remarks: number of rotations
              - column:
                  name: parent_route_id
                  type: int
                  remarks: Parent route id
                  constraints:
                    nullable: true
              - column:
                  name: created_at
                  type: timestamp
                  remarks: creation timestamp
                  constraints:
                    nullable: false
              - column:
                  name: created_by
                  type: varchar(30)
                  remarks: creation author
                  constraints:
                    nullable: false
              - column:
                  name: modified_at
                  type: timestamp
                  remarks: last modification timestamp
                  constraints:
                    nullable: true
              - column:
                  name: modified_by
                  type: varchar(30)
                  remarks: last modification author
                  constraints:
                    nullable: true
        - addAutoIncrement:
            columnDataType: int
            columnName: id
            generationType: ALWAYS
            incrementBy: 1
            startWith: 1
            tableName: routes
        - addForeignKeyConstraint:
            baseColumnNames:  parent_route_id
            baseTableName:  routes
            constraintName:  routes_parent_route_fk
            referencedColumnNames:  id
            referencedTableName: routes
            validate:  true

  - changeSet:
      id: 20200902_routes_v1_20200907_route_frequency_day_table
      context: dev or pre or pro
      author: axel.sanchezsalom
      comment: "Add route frequency day table to the database"
      changes:

        # Route Frequency Days
        - createTable:
            tableName: route_frequency_days
            columns:
              - column:
                  name: id
                  type: int
                  constraints:
                    nullable: false
                    primaryKey: true
                    primaryKeyName: route_frequency_day_id_pk
              - column:
                  name: weekday
                  type: varchar(15)
                  remarks: Weekday enum value (MONDAY, TUESDAY, etc)
              - column:
                  name: month_day
                  type: int
                  remarks: Day of month (1-31)
              - column:
                  name: route_id
                  type: int
                  constraints:
                    nullable: false
                    foreignKeyName: route_frequency_day_route_fk
                    references: routes(id)
        - addAutoIncrement:
            columnDataType: int
            columnName: id
            generationType: ALWAYS
            incrementBy: 1
            startWith: 1
            tableName: route_frequency_days

